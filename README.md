# Проектная работа "Веб-ларек"

Описание:
"Веб-ларек" - это пример интернет-магазина, реализованного с использованием TypeScript и архитектуры MVP (Model-View-Presenter). Приложение позволяет пользователям просматривать список товаров, добавлять товары в корзину и оформлять заказы.

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```


## Архитектура
Приложение разделено на три основных слоя согласно архитектуре MVP:

### Слой данных (Model)
Отвечает за хранение и управление данными приложения.

#### ItemsData: Класс для работы с данными товаров. Предоставляет методы для получения списка товаров, получения информации о конкретном товаре и т.д.

  Атрибуты:

  - `_itemsResponse: IItem[]` Массив объектов, представляющих товары, загруженные с сервера.
  - `_preview: string | null` Идентификатор товара, который выбран для предпросмотра.
  - `events: IEvents`

####  UserData: Класс для работы с данными пользователя. Хранит информацию о заказе, способе оплаты, адресе и контактных данных пользователя.

  Атрибуты:

  - `data: IUserData` Объект, содержащий данные пользователя и иформация о заказе.

  Методы:

  - `updateData(): void` Обновляет данные пользователя.
  - `getData(): IUserData` Возвращает данные пользователя.

#### BasketData: Класс для работы с корзиной покупок. Предоставляет методы для добавления/удаления товаров в корзину, подсчета общей стоимости и т.д.

  Атрибуты:

  - `items: IItem[]` Массив товаров, добавленных в корзину.
  - `events: IEvents`

  Методы:

  - `addItem(item: IItem): void` Добавляет товар в корзину.
  - `removeItem(id: string): void` Удаляет товар из корзины.
  - `isInBasket(id: string): boolean` Проверяет, находится ли товар в корзине.
  - `getItems(): IItem[]` Возвращает текущий массив товаров в корзине.
  - `getTotalItems(): number` Возвращает общее количество товаров в корзине.
  - `getTotalPrice(): number` Возвращает общую стоимость товаров в корзине.
  - `clearBasket(): void` Очищает корзину.
  - `updateBasket(): void` Обновляет состояние корзины.

### Слой представления (View)
Отвечает за отображение пользовательского интерфейса и взаимодействие с пользователем.

#### Component: Абстрактный базовый класс для всех компонентов представления. Предоставляет общие методы для отображения компонентов.

  Конструктор:

  - `constructor(protected readonly container: HTMLElement)`

  Методы:

  - `render(): HTMLElement`
  - `setText(element: HTMLElement, value: unknown): void`

#### Item: Компонент для отображения карточки товара.

  Атрибуты:

  - `template: HTMLElement`
  - `events: IEvents`

  Методы:

  - сеттеры - отвечают за присвоение данных атрибутам элементов карточки товара.
  - `get id(): string` Возвращает идентификатор товара.

#### ItemContainer: Компонент для отображения списка товаров.

  Атрибуты:

  - `modal: HTMLElement` HTML элемент модального окна.
  - `events: IEvents`

  Методы:

  - `open(): void` Открывает модальное окно.
  - `close(): void` Закрывает модальное окно.

#### ModalWithItem: Компонент для отображения модального окна с подробной информацией о товаре и возможностью добавления в корзину.

  Атрибуты:

  - `addButton: HTMLButtonElement` Кнопка для добавления товара в корзину.
  - `itemCategory: HTMLSpanElement` Элемент, отображающий категорию товара.
  - `itemTitle: HTMLElement` Элемент, отображающий название товара.
  - `itemImage: HTMLImageElement` Элемент, отображающий изображение товара.
  - `itemPrice: HTMLSpanElement` Элемент, отображающий цену товара.
  - `itemDescription: HTMLElement` Элемент, отображающий описание товара.
  - `currentItem: IItem | null` Текущий выбранный товар или null, если товар не выбран.
  - `basketData: BasketData` Объект данных корзины для взаимодействия с корзиной.

  Методы:

  - `set itemData(item: IItem)` Устанавливает данные текущего товара и обновляет отображение в модальном окне.
  - `updateButtonState(): void` Обновляет состояние кнопки добавления в корзину.

#### ModalWithBasket: Компонент для отображения модального окна с содержимым корзины и возможностью оформления заказа.

  Атрибуты:

  - `basketList: HTMLUListElement` Элемент списка для отображения товаров в корзине.
  - `basketTotalPrice: HTMLElement` Элемент для отображения общей стоимости товаров в корзине.
  - `checkoutButton: HTMLButtonElement` Кнопка для перехода к оформлению заказа.

  Методы:

  - `createBasketItem(itemData: IItem, index: number): HTMLElement` Создает элемент для отображения товара в корзине.

#### Form: Реализует общий компонент формы.

  Атрибуты:

  - `inputs: HTMLInputElement` Список всех полей ввода формы.
  - `form: HTMLFormElement` Элемент формы.
  - `errors: Record<string, string>` Объект для хранения ошибок валидации.
  - `formName: string` Поле name формы.
  - `submitButton: HTMLButtonElement` Кнопка отправки формы.
  - `errorSpan: HTMLElement` Элемент для отображения сообщений об ошибках.

  Методы:

  - `getInputValues(): Record<string, string>` Собирает и возвращает значения всех полей формы в виде объекта.
  - `setInputValues(data: Record<string, string>): void` Устанавливает значения полей формы из объекта данных.
  - `set error(data: { field: string, value: string, validInformation: string })` Принимает объект с данными для отображения или сокрытия текстов ошибок.
  - `showInputError(): void` Отображает ошибки валидации полей формы.
  - `hideInputError(): void` Скрывает ошибки валидации.
  - `validateForm(): void` Проводит валидацию всех полей формы.
  - `set valid(isValid: boolean)` Меняет состояние кнопки отправки формы в зависимости от того валидна форма или нет.
  - `get form(): HTMLElement` Возвращает элемент формы.
  - `close(): void` Закрывает форму и и фочищает ее поля.

#### OrderForm: Компонент для отображения формы оформления заказа.

  Методы:

  - `validate(): boolean`

#### ContactsForm: Реализует компонент формы контактов.

  Методы:

  - `validate(): boolean`

#### ModalWithSuccess: Компонент для отображения модального окна с успешным оформлением заказа.

  Атрибуты:

  - `total: number` Общая сумма заказа.

### Слой коммуникации и презентер (Presenter)

Отвечает за связь между слоем данных и слоем представления, а также за обработку бизнес-логики приложения.

#### AppApi: Класс для взаимодействия с сервером и выполнения HTTP-запросов.

Принимает в конструктор экземпляр класса Api и предоставляет методы реализующие взаимодействие с бэкендом сервиса.

#### EventEmitter: Класс для обработки событий и обеспечения взаимодействия между компонентами.

  Методы:

  - `on` подписка на событие.
  - `emit` инициализация события.
  - `trigger` возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие.

## Взаимодействие компонентов

Взаимодействие между компонентами осуществляется через события, которые генерируются с помощью класса EventEmitter. События позволяют избежать прямой зависимости между компонентами и облегчают управление их взаимодействием.

Основные события

- `basket:open` Открытии модального окна с корзиной.
- `initialData:loaded` Загрузка массива товаров.
- `basket:add-item` Добавлении товара в корзину.
- `basket:remove-item` Удалении товара из корзины.
- `basket:update` Обновлении состояния корзины.
- `basket:order` Подтверждении заказа пользователем.
- `order:submit` Отправке формы заказа с данными о способе оплаты и адресе.
- `contact:submit` Отправка данных пользователем.
- `success:submit` Подтверждении сообщения об успешной покупке в модальном окне.
- `item:select` Выборе товара для отображения его детальной информации в модальном окне.
- `item:check-button` Регулирует состояние кнопки.

## Структуры данных и интерфейсы приложения

Товар

```
interface IItem {
  id: string;
  title: string;
  description: string;
  price: number | null;
  category: string;
  image: string;
}
```
Каталог товаров

```
interface IItemData {
  items: IItem[];
  preview: string | null;
  getItem(itemId: string): IItem;
}
```
Данные пользователя

```
interface IUserData {
  payment?: string;
  email?: string;
  phone?: string;
  address?: string;
  total?: number;
  items?: string[];
}
```
Корзина

```
interface IBasketData {
  items: [IItem];
  total: number;
  getTotal(items: [IItem]): number;
  add(id: string): void;
  remove(id: string): void;
  checkItem(id: string): boolean;
}
```